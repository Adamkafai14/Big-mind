<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site √âducatif CP-CM2</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 90%;
            width: 500px;
        }

        .main-interface {
            width: 95%;
            max-width: 1200px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .welcome-title {
            color: #2d3748;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        input, select, button {
            padding: 15px;
            margin: 10px;
            border: 2px solid #667eea;
            border-radius: 10px;
            font-size: 16px;
            font-family: inherit;
        }

        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            cursor: pointer;
            transition: transform 0.2s;
        }

        button:hover {
            transform: scale(1.05);
        }

        .subjects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .subject-card {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.2s;
            text-align: center;
            font-weight: bold;
        }

        .subject-card:hover {
            transform: scale(1.05);
        }

        .videos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .video-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .video-card:hover {
            transform: scale(1.02);
        }

        .video-thumbnail {
            width: 100%;
            height: 160px;
            background: #f7fafc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: #667eea;
        }

        .video-info {
            padding: 15px;
        }

        .video-title {
            font-size: 14px;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
            text-align: left;
        }

        .quiz-question {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .quiz-options {
            list-style: none;
            margin: 15px 0;
        }

        .quiz-options li {
            margin: 10px 0;
            padding: 10px;
            background: #f7fafc;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .quiz-options li:hover {
            background: #e2e8f0;
        }

        .quiz-options li.selected {
            background: #667eea;
            color: white;
        }

        .quiz-options li.correct {
            background: #48bb78;
            color: white;
        }

        .quiz-options li.incorrect {
            background: #f56565;
            color: white;
        }

        .quiz-options li.disabled {
            cursor: default !important;
        }

        .back-button {
            background: #718096;
            margin: 10px;
        }

        .story-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: left;
            line-height: 1.6;
        }

        .hidden {
            display: none;
        }

        audio {
            width: 100%;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <!-- Page d'accueil -->
    <div id="welcome-page" class="container">
        <h1>üéì Bienvenue sur ton site d'apprentissage ! üéì</h1>
        
        <div id="load-profile" style="margin-bottom: 20px;">
            <h3>As-tu d√©j√† un profil ?</h3>
            <input type="file" id="profile-file" accept=".json" style="display: none;" onchange="loadProfile()">
            <button onclick="document.getElementById('profile-file').click()" style="background: #48bb78; margin: 5px;">üìÅ Charger mon profil</button>
            <button onclick="showNewProfile()" style="background: #667eea; margin: 5px;">‚ú® Cr√©er un nouveau profil</button>
            <button onclick="enterAsGuest()" style="background: #718096; margin: 5px;">üë§ Se connecter en tant qu'invit√©</button>
        </div>
        
        <div id="new-profile" class="hidden">
            <p>Pour commencer, choisis ton pseudonyme :</p>
            <input type="text" id="username" placeholder="Ton pseudonyme" maxlength="20">
            <br>
            <button onclick="enterSite()">Commencer l'aventure !</button>
        </div>
    </div>

    <!-- Interface principale -->
    <div id="main-interface" class="main-interface hidden">
        <h1 class="welcome-title">üìö Apprends quelque chose aujourd'hui ! üìö</h1>
        <p id="welcome-message" style="font-size: 1.2em; margin-bottom: 10px;"></p>
        <p id="points-display" style="font-size: 1.1em; margin-bottom: 20px; color: #667eea; font-weight: bold;">üèÜ Points : 0</p>
        
        <div id="class-selection">
            <h2>Dans quelle classe es-tu ?</h2>
            <select id="class-select">
                <option value="">Choisis ta classe</option>
                <option value="CP">CP</option>
                <option value="CE1">CE1</option>
                <option value="CE2">CE2</option>
                <option value="CM1">CM1</option>
                <option value="CM2">CM2</option>
            </select>
            <br>
            <button onclick="selectClass()">Valider</button>
        </div>

        <div id="subjects-section" class="hidden">
            <div id="save-button-container" style="text-align: right; margin-bottom: 10px;">
                <button onclick="saveProfile()" style="background: #48bb78; font-size: 12px; padding: 8px 12px;">üíæ Sauvegarder mon profil</button>
            </div>
            <h2 id="class-title"></h2>
            <div class="subjects-grid" id="subjects-grid"></div>
        </div>

        <div id="videos-section" class="hidden">
            <button class="back-button" onclick="showSubjects()">‚Üê Retour aux mati√®res</button>
            <h2 id="subject-title"></h2>
            <div class="videos-grid" id="videos-grid"></div>
        </div>

        <div id="video-player" class="hidden">
            <button class="back-button" onclick="showVideos()">‚Üê Retour aux vid√©os</button>
            <h2 id="video-title"></h2>
            <div style="text-align: center; margin: 20px 0;">
                <div class="video-info-card" style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto;">
                    <!-- Le contenu de la vid√©o sera ins√©r√© ici par JavaScript -->
                    <div class="video-thumbnail" style="background: #f7fafc; height: 200px; border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 15px;">
                        <span style="font-size: 48px; color: #667eea;">üì∫</span>
                    </div>
                    <p style="margin-bottom: 15px; color: #4a5568;">S√©lectionne une vid√©o pour la regarder !</p>
                </div>
            </div>
            <button onclick="startQuiz()" style="margin: 20px auto; display: block;">Faire le quiz sur cette vid√©o</button>
        </div>

        <div id="quiz-section" class="hidden">
            <div class="quiz-container">
                <button class="back-button" onclick="showVideoPlayer()">‚Üê Retour √† la vid√©o</button>
                <h2>Quiz : <span id="quiz-title"></span></h2>
                <div id="quiz-content"></div>
                <button id="quiz-submit" onclick="submitQuiz()" class="hidden">Voir les r√©sultats</button>
                <button id="quiz-next" onclick="nextQuestion()" class="hidden">Question suivante</button>
                <div id="quiz-results" class="hidden">
                    <h3>R√©sultats</h3>
                    <p id="quiz-score"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentUser = '';
        let currentClass = '';
        let currentSubject = '';
        let currentVideo = null;
        let currentQuizQuestions = [];
        let currentQuestionIndex = 0;
        let quizAnswers = [];
        let userProgress = {};
        let userPoints = 0;
        let isGuest = false;

        // Donn√©es des vid√©os et quiz avec les vrais titres
        const educationalContent = {
            CP: {
                'Math√©matiques': [
                    {
                        title: 'Comparer et ranger les nombres jusqu\'√† 19 - CP',
                        url: 'https://www.youtube.com/watch?v=n5_B0GdNe-M',
                        quiz: [
                            {
                                question: 'Pour comparer deux nombres, que dois-je regarder en premier ?',
                                options: ['Les unit√©s', 'Les dizaines', 'Le nombre le plus grand', 'La couleur'],
                                correct: 1,
                                explanation: 'Les dizaines sont plus importantes que les unit√©s. Un nombre avec plus de dizaines sera toujours plus grand !'
                            },
                            {
                                question: 'Entre 15 et 16, lequel est le plus grand ?',
                                options: ['15', '16', 'Ils sont √©gaux', 'Je ne sais pas'],
                                correct: 1,
                                explanation: '16 est plus grand que 15 car il a une unit√© de plus !'
                            },
                            {
                                question: 'Le signe ">" signifie :',
                                options: ['Plus petit que', 'Plus grand que', '√âgal √†', 'Diff√©rent de'],
                                correct: 1,
                                explanation: 'Le signe ">" ressemble √† une bouche qui mange le plus petit nombre, donc il montre que le nombre de gauche est plus grand !'
                            }
                        ]
                    },
                    {
                        title: 'Les doubles - CP CE1',
                        url: 'https://www.youtube.com/watch?v=G2827u4NpwU',
                        quiz: [
                            {
                                question: 'Qu\'est-ce qu\'un double ?',
                                options: ['Deux nombres diff√©rents', 'Le m√™me nombre ajout√© deux fois', 'Un grand nombre', 'Un nombre pair'],
                                correct: 1,
                                explanation: 'Un double, c\'est quand on ajoute un nombre √† lui-m√™me, comme 3 + 3 = 6 !'
                            },
                            {
                                question: 'Quel est le double de 4 ?',
                                options: ['6', '7', '8', '9'],
                                correct: 2,
                                explanation: 'Le double de 4, c\'est 4 + 4 = 8 !'
                            },
                            {
                                question: 'Comment calcule-t-on le double de 3 ?',
                                options: ['3 + 1', '3 + 2', '3 + 3', '3 + 4'],
                                correct: 2,
                                explanation: 'Pour calculer le double, on ajoute le nombre √† lui-m√™me : 3 + 3 !'
                            }
                        ]
                    },
                    {
                        title: 'Pair et impair - CP',
                        url: 'https://www.youtube.com/watch?v=3b3SGjBuKMc',
                        quiz: [
                            {
                                question: 'Comment reconna√Æt-on un nombre pair ?',
                                options: ['Il finit par 1, 3, 5, 7 ou 9', 'Il finit par 0, 2, 4, 6 ou 8', 'Il est grand', 'Il est petit'],
                                correct: 1,
                                explanation: 'Les nombres pairs finissent toujours par 0, 2, 4, 6 ou 8. On peut les partager en deux groupes √©gaux !'
                            },
                            {
                                question: 'Le nombre 6 est-il pair ou impair ?',
                                options: ['Pair', 'Impair', 'Ni l\'un ni l\'autre', 'Je ne sais pas'],
                                correct: 0,
                                explanation: '6 est pair car il finit par 6, et on peut faire 6 √∑ 2 = 3 !'
                            }
                        ]
                    },
                    {
                        title: 'Soustractions simples - CP',
                        url: 'https://www.youtube.com/watch?v=-Ga6DhnJPpE',
                        quiz: [
                            {
                                question: 'Combien font 5 - 2 ?',
                                options: ['2', '3', '4', '5'],
                                correct: 1,
                                explanation: 'Si tu as 5 objets et que tu en enl√®ves 2, il te reste 3 objets !'
                            },
                            {
                                question: 'Qu\'est-ce qu\'une soustraction ?',
                                options: ['Ajouter des nombres', 'Enlever des objets', 'Compter', 'Multiplier'],
                                correct: 1,
                                explanation: 'Une soustraction, c\'est quand on retire ou on enl√®ve des choses !'
                            }
                        ]
                    },
                    {
                        title: 'Les unit√©s et dizaines',
                        url: 'https://www.youtube.com/watch?v=fvHSskq-8_8',
                        quiz: [
                            {
                                question: 'Dans le nombre 23, quel chiffre repr√©sente les unit√©s ?',
                                options: ['2', '3', '23', '20'],
                                correct: 1,
                                explanation: 'Dans 23, le chiffre 3 est dans la colonne des unit√©s (√† droite) !'
                            },
                            {
                                question: 'Dans le nombre 47, combien y a-t-il de dizaines ?',
                                options: ['4', '7', '10', '40'],
                                correct: 0,
                                explanation: 'Dans 47, il y a 4 dizaines (le chiffre de gauche) !'
                            },
                            {
                                question: 'Que vaut 3 dizaines et 5 unit√©s ?',
                                options: ['35', '53', '8', '30'],
                                correct: 0,
                                explanation: '3 dizaines et 5 unit√©s = 30 + 5 = 35 !'
                            },
                            {
                                question: 'Comment d√©compose-t-on le nombre 19 ?',
                                options: ['1 + 9', '10 + 9', '19 + 0', '2 + 7'],
                                correct: 1,
                                explanation: '19 = 1 dizaine + 9 unit√©s = 10 + 9 !'
                            }
                        ]
                    },
                    {
                        title: 'Les formes g√©om√©triques',
                        url: 'https://www.youtube.com/watch?v=HkcLxx_E7XE',
                        quiz: [
                            {
                                question: 'Combien de c√¥t√©s a un triangle ?',
                                options: ['2', '3', '4', '5'],
                                correct: 1,
                                explanation: 'Un triangle a toujours 3 c√¥t√©s et 3 sommets !'
                            },
                            {
                                question: 'Quelle forme a 4 c√¥t√©s √©gaux ?',
                                options: ['Triangle', 'Carr√©', 'Cercle', 'Rectangle'],
                                correct: 1,
                                explanation: 'Un carr√© a 4 c√¥t√©s tous √©gaux et 4 angles droits !'
                            },
                            {
                                question: 'Quelle forme n\'a pas de c√¥t√©s ?',
                                options: ['Triangle', 'Carr√©', 'Cercle', 'Rectangle'],
                                correct: 2,
                                explanation: 'Un cercle n\'a pas de c√¥t√©s, c\'est une forme ronde !'
                            },
                            {
                                question: 'Un rectangle a :',
                                options: ['3 c√¥t√©s', '4 c√¥t√©s √©gaux', '4 c√¥t√©s (2 longs, 2 courts)', 'Pas de c√¥t√©s'],
                                correct: 2,
                                explanation: 'Un rectangle a 4 c√¥t√©s : 2 longs c√¥t√©s √©gaux et 2 courts c√¥t√©s √©gaux !'
                            }
                        ]
                    },
                    {
                        title: 'Les suites de nombres',
                        url: 'https://www.youtube.com/watch?v=7kdCpfjRfPM',
                        quiz: [
                            {
                                question: 'Dans la suite 2, 4, 6, 8, quel nombre vient apr√®s ?',
                                options: ['9', '10', '11', '12'],
                                correct: 1,
                                explanation: 'On ajoute 2 √† chaque fois : 2, 4, 6, 8, 10 !'
                            },
                            {
                                question: 'Quelle est la r√®gle de la suite : 1, 3, 5, 7 ?',
                                options: ['On ajoute 1', 'On ajoute 2', 'On ajoute 3', 'On ajoute 4'],
                                correct: 1,
                                explanation: 'On ajoute 2 √† chaque fois : 1+2=3, 3+2=5, 5+2=7 !'
                            },
                            {
                                question: 'Continue la suite : 10, 15, 20, 25, ?',
                                options: ['26', '27', '30', '35'],
                                correct: 2,
                                explanation: 'On ajoute 5 √† chaque fois : 25 + 5 = 30 !'
                            },
                            {
                                question: 'Dans la suite 5, 10, 15, 20, combien ajoute-t-on √† chaque fois ?',
                                options: ['3', '4', '5', '6'],
                                correct: 2,
                                explanation: 'On ajoute 5 : 5+5=10, 10+5=15, 15+5=20 !'
                            }
                        ]
                    },
                    {
                        title: 'Les unit√©s de mesure - longueurs',
                        url: 'https://www.youtube.com/watch?v=n9HIfyMWhwI',
                        quiz: [
                            {
                                question: 'Avec quoi mesure-t-on une longueur ?',
                                options: ['Une balance', 'Une r√®gle', 'Un thermom√®tre', 'Une montre'],
                                correct: 1,
                                explanation: 'On mesure une longueur avec une r√®gle, un m√®tre ou un double-m√®tre !'
                            },
                            {
                                question: 'Quelle est l\'unit√© pour mesurer les longueurs ?',
                                options: ['Le kilogramme', 'Le m√®tre', 'Le litre', 'La seconde'],
                                correct: 1,
                                explanation: 'Le m√®tre est l\'unit√© principale pour mesurer les longueurs !'
                            },
                            {
                                question: 'Qu\'est-ce qui est le plus long ?',
                                options: ['1 centim√®tre', '1 m√®tre', '1 millim√®tre', 'Un crayon'],
                                correct: 1,
                                explanation: '1 m√®tre est le plus long : 1 m√®tre = 100 centim√®tres = 1000 millim√®tres !'
                            }
                        ]
                    },
                    {
                        title: 'Comparer des longueurs',
                        url: 'https://www.youtube.com/watch?v=DRhaddgFwHU',
                        quiz: [
                            {
                                question: 'Regarde ces deux lignes : ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî et ‚Äî‚Äî‚Äî‚Äî Laquelle est la plus longue ?',
                                options: ['La premi√®re ligne', 'La deuxi√®me ligne', 'Elles sont √©gales', 'On ne peut pas savoir'],
                                correct: 0,
                                explanation: 'La premi√®re ligne est plus longue car elle a plus de tirets !'
                            },
                            {
                                question: 'Pour comparer deux objets, je peux :',
                                options: ['Les mettre c√¥te √† c√¥te', 'Fermer les yeux', 'Les m√©langer', 'Les casser'],
                                correct: 0,
                                explanation: 'En mettant les objets c√¥te √† c√¥te, on voit facilement lequel est le plus long !'
                            },
                            {
                                question: 'Qu\'est-ce qui est le plus long ?',
                                options: ['üìè Une r√®gle', '‚úèÔ∏è Un crayon', 'üìé Un trombone', 'üîç Une loupe'],
                                correct: 0,
                                explanation: 'Une r√®gle est plus longue qu\'un crayon, un trombone ou une loupe !'
                            },
                            {
                                question: 'Entre üöó une voiture et üö≤ un v√©lo, qu\'est-ce qui est le plus long ?',
                                options: ['üöó La voiture', 'üö≤ Le v√©lo', 'C\'est pareil', 'Je ne sais pas'],
                                correct: 0,
                                explanation: 'Une voiture est plus longue qu\'un v√©lo !'
                            }
                        ]
                    }
                ],
                'Fran√ßais': [
                    {
                        title: 'La phrase - CP',
                        url: 'https://www.youtube.com/watch?v=KoR3qJK_wEc',
                        quiz: [
                            {
                                question: 'Comment commence une phrase ?',
                                options: ['Par une minuscule', 'Par une majuscule', 'Par un point', 'Par une virgule'],
                                correct: 1,
                                explanation: 'Une phrase commence toujours par une lettre majuscule !'
                            },
                            {
                                question: 'Comment se termine une phrase ?',
                                options: ['Par une majuscule', 'Par une virgule', 'Par un point', 'Par un mot'],
                                correct: 2,
                                explanation: 'Une phrase se termine toujours par un point pour montrer qu\'elle est finie !'
                            }
                        ]
                    },
                    {
                        title: 'Les types de phrases - CP',
                        url: 'https://www.youtube.com/watch?v=aGW2DfMLhCY',
                        quiz: [
                            {
                                question: 'Comment se termine une phrase interrogative ?',
                                options: ['Par un point', 'Par un point d\'exclamation', 'Par un point d\'interrogation', 'Par une virgule'],
                                correct: 2,
                                explanation: 'Une phrase interrogative se termine par un point d\'interrogation (?) car on pose une question !'
                            },
                            {
                                question: 'Quelle phrase est interrogative ?',
                                options: ['Tu viens jouer.', 'Comme c\'est beau !', 'Veux-tu jouer ?', 'Viens ici.'],
                                correct: 2,
                                explanation: '"Veux-tu jouer ?" est une question, donc une phrase interrogative !'
                            },
                            {
                                question: 'Quel signe utilise-t-on pour une phrase exclamative ?',
                                options: ['?', '!', '.', ','],
                                correct: 1,
                                explanation: 'Le point d\'exclamation (!) montre la surprise, la joie ou l\'√©tonnement !'
                            }
                        ]
                    },
                    {
                        title: 'Le verbe',
                        url: 'https://www.youtube.com/watch?v=CBGA58qRawU',
                        quiz: [
                            {
                                question: 'Dans la phrase "Le chat mange", quel est le verbe ?',
                                options: ['Le', 'chat', 'mange', 'Le chat'],
                                correct: 2,
                                explanation: 'Le verbe "mange" dit ce que fait le chat. C\'est l\'action !'
                            },
                            {
                                question: 'Qu\'est-ce qu\'un verbe ?',
                                options: ['Un nom', 'Une action', 'Une couleur', 'Un chiffre'],
                                correct: 1,
                                explanation: 'Un verbe exprime une action : courir, manger, dormir, jouer...'
                            },
                            {
                                question: 'Dans "Papa lit un livre", que fait Papa ?',
                                options: ['Il mange', 'Il lit', 'Il dort', 'Il chante'],
                                correct: 1,
                                explanation: 'Papa LIT. "Lire" est le verbe qui montre l\'action de Papa !'
                            },
                            {
                                question: 'Lequel est un verbe ?',
                                options: ['chien', 'courir', 'rouge', 'maison'],
                                correct: 1,
                                explanation: 'Courir est un verbe d\'action. On peut courir !'
                            }
                        ]
                    },
                    {
                        title: 'Les lettres et les mots',
                        url: 'https://www.youtube.com/watch?v=DR_66o6DOeI',
                        quiz: [
                            {
                                question: 'Avec quoi forme-t-on des mots ?',
                                options: ['Des chiffres', 'Des lettres', 'Des couleurs', 'Des formes'],
                                correct: 1,
                                explanation: 'On forme des mots avec des lettres ! Comme C-H-A-T forme le mot CHAT !'
                            },
                            {
                                question: 'Combien y a-t-il de lettres dans l\'alphabet ?',
                                options: ['24', '25', '26', '27'],
                                correct: 2,
                                explanation: 'Il y a 26 lettres dans l\'alphabet fran√ßais, de A √† Z !'
                            },
                            {
                                question: 'Le mot "PAPA" a combien de lettres ?',
                                options: ['3', '4', '5', '6'],
                                correct: 1,
                                explanation: 'PAPA a 4 lettres : P-A-P-A !'
                            },
                            {
                                question: 'Quelles sont les voyelles ?',
                                options: ['B, C, D, F', 'A, E, I, O, U', 'L, M, N, P', 'R, S, T, V'],
                                correct: 1,
                                explanation: 'Les voyelles sont A, E, I, O, U. Toutes les autres lettres sont des consonnes !'
                            }
                        ]
                    },
                    {
                        title: 'Singulier et pluriel',
                        url: 'https://www.youtube.com/watch?v=liuYTks6rCs',
                        quiz: [
                            {
                                question: 'Le mot "chat" est au singulier. Comment √©crit-on le pluriel ?',
                                options: ['chat', 'chats', 'chates', 'chatss'],
                                correct: 1,
                                explanation: 'Au pluriel, on ajoute un "s" : chat devient chats !'
                            },
                            {
                                question: 'Qu\'est-ce que le singulier ?',
                                options: ['Plusieurs objets', 'Un seul objet', 'Beaucoup d\'objets', 'Z√©ro objet'],
                                correct: 1,
                                explanation: 'Le singulier, c\'est quand il y a UN SEUL objet : un chat, une maison !'
                            },
                            {
                                question: 'Le mot "livres" est au pluriel. Comment √©crit-on le singulier ?',
                                options: ['livre', 'livres', 'livress', 'livrer'],
                                correct: 0,
                                explanation: 'Au singulier, on enl√®ve le "s" : livres devient livre !'
                            },
                            {
                                question: 'Quand utilise-t-on le pluriel ?',
                                options: ['Pour un seul objet', 'Pour plusieurs objets', 'Pour les couleurs', 'Pour les chiffres'],
                                correct: 1,
                                explanation: 'On utilise le pluriel quand il y a PLUSIEURS objets : des chats, des maisons !'
                            }
                        ]
                    },
                    {
                        title: 'Lettres, sons et syllabes',
                        url: 'https://www.youtube.com/watch?v=ZtfSvJcgNqU',
                        quiz: [
                            {
                                question: 'Quel son fait la lettre "B" ?',
                                options: ['[p]', '[b]', '[d]', '[t]'],
                                correct: 1,
                                explanation: 'La lettre B fait le son [b], comme dans BATEAU ou B√âB√â !'
                            },
                            {
                                question: 'Combien de syllabes dans le mot "CHOCOLAT" ?',
                                options: ['2', '3', '4', '5'],
                                correct: 1,
                                explanation: 'CHOCOLAT a 3 syllabes : CHO-CO-LAT !'
                            },
                            {
                                question: 'Avec quelle lettre √©crit-on le son [f] ?',
                                options: ['V', 'F', 'P', 'B'],
                                correct: 1,
                                explanation: 'Le son [f] s\'√©crit avec la lettre F, comme dans FILLE ou FLEUR !'
                            },
                            {
                                question: 'Dans le mot "MAMAN", quelle est la premi√®re syllabe ?',
                                options: ['MA', 'MAN', 'AM', 'AN'],
                                correct: 0,
                                explanation: 'La premi√®re syllabe de MAMAN est MA. MAMAN = MA-MAN !'
                            }
                        ]
                    },
                    {
                        title: 'Les phrases affirmatives et n√©gatives',
                        url: 'https://www.youtube.com/watch?v=zNHm9LvsxqE',
                        quiz: [
                            {
                                question: 'Quelle phrase est affirmative ?',
                                options: ['Je ne mange pas.', 'Il ne dort pas.', 'Le chat mange.', 'Tu ne viens pas.'],
                                correct: 2,
                                explanation: '"Le chat mange." est affirmative car elle dit OUI, elle affirme quelque chose !'
                            },
                            {
                                question: 'Comment transformer "Il mange" en phrase n√©gative ?',
                                options: ['Il mange pas', 'Il ne mange pas', 'Il mange non', 'Pas il mange'],
                                correct: 1,
                                explanation: 'On ajoute "ne...pas" : Il ne mange pas !'
                            },
                            {
                                question: 'Quelle phrase est n√©gative ?',
                                options: ['Papa lit.', 'Maman cuisine.', 'Je ne joue pas.', 'Tu cours.'],
                                correct: 2,
                                explanation: '"Je ne joue pas" est n√©gative car elle dit NON avec "ne...pas" !'
                            },
                            {
                                question: 'Dans une phrase n√©gative, on utilise :',
                                options: ['ne...pas', 'tr√®s...bien', 'le...la', 'un...une'],
                                correct: 0,
                                explanation: 'Pour faire une phrase n√©gative, on utilise "ne...pas" : Je ne veux pas !'
                            }
                        ]
                    },
                    {
                        title: 'Le pass√©, pr√©sent et futur',
                        url: 'https://www.youtube.com/watch?v=R19HiQtL2Rk',
                        quiz: [
                            {
                                question: 'Quelle phrase parle du pr√©sent ?',
                                options: ['Hier, j\'ai jou√©.', 'Je joue maintenant.', 'Demain, je jouerai.', 'La semaine derni√®re.'],
                                correct: 1,
                                explanation: '"Je joue maintenant" se passe au pr√©sent, en ce moment !'
                            },
                            {
                                question: 'Qu\'est-ce que le pass√© ?',
                                options: ['Ce qui va arriver', 'Ce qui se passe maintenant', 'Ce qui s\'est d√©j√† pass√©', 'Ce qui ne se passe jamais'],
                                correct: 2,
                                explanation: 'Le pass√©, c\'est ce qui s\'est d√©j√† pass√©, avant maintenant !'
                            },
                            {
                                question: 'Quelle phrase parle du futur ?',
                                options: ['Je mange une pomme.', 'J\'ai mang√© une pomme.', 'Je mangerai une pomme.', 'Je ne mange pas.'],
                                correct: 2,
                                explanation: '"Je mangerai" parle du futur, de ce qui va se passer plus tard !'
                            },
                            {
                                question: 'Quand dit-on "demain" ?',
                                options: ['Pour le pass√©', 'Pour le pr√©sent', 'Pour le futur', 'Pour jamais'],
                                correct: 2,
                                explanation: '"Demain" parle du futur, de ce qui va arriver !'
                            }
                        ]
                    },
                    {
                        title: 'La phrase interrogative',
                        url: 'https://www.youtube.com/watch?v=-0BnEnS8SRc',
                        quiz: [
                            {
                                question: 'Comment se termine une phrase interrogative ?',
                                options: ['Par un point .', 'Par un point d\'interrogation ?', 'Par un point d\'exclamation !', 'Par une virgule ,'],
                                correct: 1,
                                explanation: 'Une phrase interrogative se termine toujours par un point d\'interrogation ? !'
                            },
                            {
                                question: 'Quelle phrase est interrogative ?',
                                options: ['Tu joues au ballon.', 'Veux-tu jouer ?', 'Je mange une pomme.', 'Comme c\'est beau !'],
                                correct: 1,
                                explanation: '"Veux-tu jouer ?" est une question, donc une phrase interrogative !'
                            },
                            {
                                question: '√Ä quoi sert une phrase interrogative ?',
                                options: ['√Ä dire quelque chose', '√Ä poser une question', '√Ä donner un ordre', '√Ä s\'exclamer'],
                                correct: 1,
                                explanation: 'Une phrase interrogative sert √† poser une question pour avoir une r√©ponse !'
                            },
                            {
                                question: 'Quel mot peut commencer une phrase interrogative ?',
                                options: ['Le', 'Tr√®s', 'Comment', 'Joli'],
                                correct: 2,
                                explanation: '"Comment" peut commencer une question : Comment √ßa va ? !'
                            }
                        ]
                    },
                    {
                        title: 'Copier des mots et des phrases',
                        url: 'https://www.youtube.com/watch?v=Y0dYA4fZjpI',
                        quiz: [
                            {
                                question: 'Pour bien copier un mot, je dois :',
                                options: ['√âcrire tr√®s vite', 'Regarder chaque lettre', 'Deviner', 'Copier de m√©moire'],
                                correct: 1,
                                explanation: 'Pour bien copier, je regarde chaque lettre une par une !'
                            },
                            {
                                question: 'Quand je copie une phrase, je commence par :',
                                options: ['Une minuscule', 'Une majuscule', 'Un point', 'Une virgule'],
                                correct: 1,
                                explanation: 'Une phrase commence toujours par une majuscule !'
                            },
                            {
                                question: 'Quand je copie, je dois faire attention :',
                                options: ['Aux espaces entre les mots', '√Ä la couleur', '√Ä la taille', 'Au bruit'],
                                correct: 0,
                                explanation: 'Il faut bien respecter les espaces entre les mots quand on copie !'
                            },
                            {
                                question: 'Pour copier le mot "CHAT", je trace :',
                                options: ['C-H-A-T', 'T-A-H-C', 'A-T-H-C', 'H-C-A-T'],
                                correct: 0,
                                explanation: 'Je copie les lettres dans le bon ordre : C-H-A-T !'
                            }
                        ]
                    },
                    {
                        title: 'Histoire : Le loup et les chaussures magiques',
                        url: 'https://www.youtube.com/watch?v=vrVr81xy-7Q',
                        quiz: [
                            {
                                question: 'Dans l\'histoire, que trouve le loup ?',
                                options: ['Des chaussures ordinaires', 'Des chaussures magiques', 'Des bottes en cuir', 'Des sandales'],
                                correct: 1,
                                explanation: 'Le loup trouve des chaussures magiques qui ont des pouvoirs sp√©ciaux !'
                            },
                            {
                                question: 'Que permettent de faire les chaussures magiques ?',
                                options: ['De mieux marcher', 'De courir tr√®s vite', 'De voler', 'De devenir invisible'],
                                correct: 1,
                                explanation: 'Les chaussures magiques permettent au loup de courir tr√®s vite !'
                            },
                            {
                                question: 'Comment se termine cette histoire ?',
                                options: ['Le loup garde les chaussures', 'Le loup rend les chaussures', 'Les chaussures disparaissent', 'Le loup les perd'],
                                correct: 1,
                                explanation: '√Ä la fin, le loup apprend √† partager et rend les chaussures magiques !'
                            },
                            {
                                question: 'Quelle le√ßon apprend le loup ?',
                                options: ['√Ä √™tre m√©chant', '√Ä partager', '√Ä courir', '√Ä se cacher'],
                                correct: 1,
                                explanation: 'Le loup apprend qu\'il est important de partager avec les autres !'
                            }
                        ]
                    }
                ],
                'Histoire-G√©ographie': [
                    {
                        title: 'Pays, oc√©ans et continents',
                        url: 'https://www.youtube.com/watch?v=h_YkcmbRR4Q',
                        quiz: [
                            {
                                question: 'Quelle est la capitale de la France ?',
                                options: ['Lyon', 'Marseille', 'Paris', 'Bordeaux'],
                                correct: 2,
                                explanation: 'Paris est la capitale de la France, c\'est l√† que vit le Pr√©sident !'
                            },
                            {
                                question: 'Dans quel pays vivons-nous ?',
                                options: ['Espagne', 'Italie', 'France', 'Allemagne'],
                                correct: 2,
                                explanation: 'Nous vivons en France, notre pays !'
                            },
                            {
                                question: 'Combien y a-t-il de continents ?',
                                options: ['5', '6', '7', '8'],
                                correct: 2,
                                explanation: 'Il y a 7 continents : Europe, Asie, Afrique, Am√©rique du Nord, Am√©rique du Sud, Oc√©anie et Antarctique !'
                            }
                        ]
                    },
                    {
                        title: 'Les saisons et le temps',
                        url: 'https://www.youtube.com/watch?v=E44fl8ZjtHM',
                        quiz: [
                            {
                                question: 'Combien y a-t-il de saisons ?',
                                options: ['3', '4', '5', '6'],
                                correct: 1
                            }
                        ]
                    },
                    {
                        title: 'La France et ses voisins',
                        url: 'https://www.youtube.com/watch?v=0hYCCSm3qDs',
                        quiz: [
                            {
                                question: 'Quel pays se trouve au sud de la France ?',
                                options: ['Allemagne', 'Belgique', 'Espagne', 'Italie'],
                                correct: 2
                            }
                        ]
                    },
                    {
                        title: 'Les monuments de France',
                        url: 'https://www.youtube.com/watch?v=nMX0NbKCWmg',
                        quiz: [
                            {
                                question: 'Quel monument c√©l√®bre se trouve √† Paris ?',
                                options: ['Le Colis√©e', 'La Tour Eiffel', 'Big Ben', 'La Statue de la Libert√©'],
                                correct: 1
                            }
                        ]
                    },
                    {
                        title: 'Les r√©gions de France',
                        url: 'https://www.youtube.com/watch?v=CbnALShWAkc',
                        quiz: [
                            {
                                question: 'Dans quelle r√©gion se trouve Paris ?',
                                options: ['Provence', 'Bretagne', '√éle-de-France', 'Normandie'],
                                correct: 2
                            }
                        ]
                    },
                    {
                        title: 'Se rep√©rer sur une carte',
                        url: 'https://www.youtube.com/watch?v=8020w5OPi2E',
                        quiz: [
                            {
                                question: 'Sur une carte, le nord se trouve :',
                                options: ['En bas', 'En haut', '√Ä droite', '√Ä gauche'],
                                correct: 1
                            }
                        ]
                    },
                    {
                        title: 'Le temps qui passe - calendrier',
                        url: 'https://www.youtube.com/watch?v=7c9AGmps8ZA',
                        quiz: [
                            {
                                question: 'Combien y a-t-il de jours dans une semaine ?',
                                options: ['5', '6', '7', '8'],
                                correct: 2
                            }
                        ]
                    }
                ],
                'Sciences': [
                    {
                        title: 'Le corps humain - CP',
                        url: 'https://www.youtube.com/watch?v=fW8bwgRDxSY',
                        quiz: [
                            {
                                question: 'Avec quoi voyons-nous ?',
                                options: ['Les oreilles', 'Le nez', 'Les yeux', 'La bouche'],
                                correct: 2
                            }
                        ]
                    },
                    {
                        title: 'Les animaux et leurs petits',
                        url: 'https://www.youtube.com/watch?v=W7kfkC5Ru6Y',
                        quiz: [
                            {
                                question: 'Comment appelle-t-on le petit du chat ?',
                                options: ['Le chiot', 'Le chaton', 'Le poussin', 'L\'agneau'],
                                correct: 1
                            }
                        ]
                    },
                    {
                        title: 'Les plantes et la nature',
                        url: 'https://www.youtube.com/watch?v=PysS4PzQTUg',
                        quiz: [
                            {
                                question: 'De quoi ont besoin les plantes pour grandir ?',
                                options: ['Du chocolat', 'De l\'eau et du soleil', 'Des bonbons', 'De la t√©l√©vision'],
                                correct: 1
                            }
                        ]
                    },
                    {
                        title: 'L\'eau dans la nature',
                        url: 'https://www.youtube.com/watch?v=XSihVvrnK9g',
                        quiz: [
                            {
                                question: 'D\'o√π vient la pluie ?',
                                options: ['Des arbres', 'Des nuages', 'De la terre', 'Du soleil'],
                                correct: 1
                            }
                        ]
                    },
                    {
                        title: 'Les mat√©riaux - bois, plastique, m√©tal',
                        url: 'https://www.youtube.com/watch?v=LHQKXtUxtUQ',
                        quiz: [
                            {
                                question: 'D\'o√π vient le bois ?',
                                options: ['Des pierres', 'Des arbres', 'De l\'eau', 'Du sable'],
                                correct: 1
                            }
                        ]
                    },
                    {
                        title: 'Le jour et la nuit',
                        url: 'https://www.youtube.com/watch?v=ZPqYwqsXQik',
                        quiz: [
                            {
                                question: 'Que voit-on dans le ciel le jour ?',
                                options: ['La lune', 'Les √©toiles', 'Le soleil', 'Rien'],
                                correct: 2
                            }
                        ]
                    },
                    {
                        title: 'Les objets qui flottent ou coulent',
                        url: 'https://www.youtube.com/watch?v=WmK2CHR31nc',
                        quiz: [
                            {
                                question: 'Que fait une pierre dans l\'eau ?',
                                options: ['Elle flotte', 'Elle coule', 'Elle dispara√Æt', 'Elle vole'],
                                correct: 1
                            }
                        ]
                    },
                    {
                        title: 'Les √™tres vivants et non-vivants',
                        url: 'https://www.youtube.com/watch?v=BWmoEXCCraM',
                        quiz: [
                            {
                                question: 'Qu\'est-ce qui caract√©rise un √™tre vivant ?',
                                options: ['Il bouge', 'Il grandit et se reproduit', 'Il est grand', 'Il est color√©'],
                                correct: 1
                            }
                        ]
                    }
                ],
                'Autres': [
                    {
                        title: 'Apprendre en s\'amusant - CP',
                        url: 'https://www.youtube.com/watch?v=jK_HKdDkLvM',
                        quiz: [
                            {
                                question: 'Pourquoi est-il important d\'apprendre ?',
                                options: ['Pour avoir de bonnes notes', 'Pour grandir et comprendre le monde', 'Pour faire plaisir aux parents', 'Pour passer le temps'],
                                correct: 1
                            }
                        ]
                    }
                ]
            }
        };

        // Fonction pour mettre √† jour l'affichage des points
        function updatePointsDisplay() {
            const pointsElement = document.getElementById('points-display');
            if (pointsElement) {
                pointsElement.textContent = `üèÜ Points : ${userPoints}`;
            }
        }

        // Fonction pour se connecter en tant qu'invit√©
        function enterAsGuest() {
            currentUser = 'Invit√©';
            userPoints = 0;
            isGuest = true;
            document.getElementById('welcome-page').classList.add('hidden');
            document.getElementById('main-interface').classList.remove('hidden');
            document.getElementById('welcome-message').textContent = `Bonjour Invit√© ! Bienvenue üéâ`;
            updatePointsDisplay();
        }

        // Fonction pour afficher le formulaire de nouveau profil
        function showNewProfile() {
            document.getElementById('load-profile').classList.add('hidden');
            document.getElementById('new-profile').classList.remove('hidden');
        }

        // Fonction pour charger un profil existant
        function loadProfile() {
            const fileInput = document.getElementById('profile-file');
            const file = fileInput.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const profile = JSON.parse(e.target.result);
                        currentUser = profile.username || '';
                        currentClass = profile.class || '';
                        userProgress = profile.progress || {};
                        userPoints = profile.points || 0;
                        
                        if (currentUser && currentClass) {
                            document.getElementById('welcome-page').classList.add('hidden');
                            document.getElementById('main-interface').classList.remove('hidden');
                            document.getElementById('welcome-message').textContent = `Bonjour ${currentUser} ! Content de te revoir üòä`;
                            updatePointsDisplay();
                            document.getElementById('class-selection').classList.add('hidden');
                            showSubjects();
                        } else {
                            alert('Fichier de profil invalide.');
                        }
                    } catch (error) {
                        alert('Erreur lors du chargement du profil.');
                    }
                };
                reader.readAsText(file);
            }
        }

        // Fonction pour entrer dans le site
        function enterSite() {
            const username = document.getElementById('username').value.trim();
            if (username) {
                currentUser = username;
                userPoints = 0; // Nouveau utilisateur commence avec 0 points
                isGuest = false;
                document.getElementById('welcome-page').classList.add('hidden');
                document.getElementById('main-interface').classList.remove('hidden');
                document.getElementById('welcome-message').textContent = `Bonjour ${username} ! Bienvenue üéâ`;
                updatePointsDisplay();
                
                // Sauvegarde automatique du profil
                setTimeout(() => {
                    autoSaveProfile();
                }, 1000);
            } else {
                alert('Merci d\'√©crire ton pseudonyme !');
            }
        }

        // Fonction pour s√©lectionner la classe
        function selectClass() {
            const selectedClass = document.getElementById('class-select').value;
            if (selectedClass) {
                currentClass = selectedClass;
                document.getElementById('class-selection').classList.add('hidden');
                showSubjects();
                
                // Sauvegarde automatique apr√®s s√©lection de classe (seulement si pas invit√©)
                if (!isGuest) {
                    setTimeout(() => {
                        autoSaveProfile();
                    }, 1000);
                }
            } else {
                alert('Merci de choisir ta classe !');
            }
        }

        // Fonction pour afficher les mati√®res
        function showSubjects() {
            document.getElementById('subjects-section').classList.remove('hidden');
            document.getElementById('videos-section').classList.add('hidden');
            document.getElementById('video-player').classList.add('hidden');
            document.getElementById('quiz-section').classList.add('hidden');
            
            document.getElementById('class-title').textContent = `Classe de ${currentClass}`;
            
            // Masquer le bouton de sauvegarde pour les invit√©s
            const saveButtonContainer = document.getElementById('save-button-container');
            if (isGuest) {
                saveButtonContainer.style.display = 'none';
            } else {
                saveButtonContainer.style.display = 'block';
            }
            
            const subjectsGrid = document.getElementById('subjects-grid');
            subjectsGrid.innerHTML = '';
            
            if (educationalContent[currentClass]) {
                Object.keys(educationalContent[currentClass]).forEach(subject => {
                    const subjectCard = document.createElement('div');
                    subjectCard.className = 'subject-card';
                    subjectCard.textContent = subject;
                    subjectCard.onclick = () => showVideos(subject);
                    subjectsGrid.appendChild(subjectCard);
                });
            }
        }

        // Fonction pour extraire l'ID YouTube d'une URL
        function getYouTubeID(url) {
            const regex = /(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        // Fonction pour afficher les vid√©os
        function showVideos(subject) {
            if (subject) currentSubject = subject;
            
            document.getElementById('subjects-section').classList.add('hidden');
            document.getElementById('videos-section').classList.remove('hidden');
            document.getElementById('video-player').classList.add('hidden');
            document.getElementById('quiz-section').classList.add('hidden');
            
            document.getElementById('subject-title').textContent = currentSubject;
            
            const videosGrid = document.getElementById('videos-grid');
            videosGrid.innerHTML = '';
            
            if (educationalContent[currentClass] && educationalContent[currentClass][currentSubject]) {
                console.log('Affichage des vid√©os pour:', currentClass, currentSubject);
                console.log('Nombre de vid√©os:', educationalContent[currentClass][currentSubject].length);
                
                educationalContent[currentClass][currentSubject].forEach((video, index) => {
                    console.log('Cr√©ation de la carte vid√©o:', index, video.title);
                    
                    const videoCard = document.createElement('div');
                    videoCard.className = 'video-card';
                    videoCard.style.cursor = 'pointer';
                    
                    videoCard.innerHTML = `
                        <div class="video-thumbnail" style="cursor: pointer;">üìπ</div>
                        <div class="video-info" style="cursor: pointer;">
                            <div class="video-title">${video.title}</div>
                            <p style="font-size: 12px; color: #666; margin-top: 5px;">Cliquez pour regarder la vid√©o</p>
                        </div>
                    `;
                    
                    // Ajouter l'√©v√©nement de clic APR√àS avoir d√©fini innerHTML
                    videoCard.addEventListener('click', function(e) {
                        console.log('CLIC D√âTECT√â sur la vid√©o:', video.title);
                        console.log('Objet vid√©o complet:', video);
                        currentVideo = video;
                        console.log('Appel de showVideoPlayer...');
                        try {
                            console.log('Avant appel showVideoPlayer');
                            if (typeof showVideoPlayer === 'function') {
                                console.log('showVideoPlayer est bien une fonction');
                                showVideoPlayer(video);
                            } else {
                                console.error('showVideoPlayer n\'est pas une fonction!', typeof showVideoPlayer);
                            }
                        } catch (error) {
                            console.error('Erreur dans showVideoPlayer:', error);
                        }
                    });
                    
                    videosGrid.appendChild(videoCard);
                    
                    // Cr√©er un conteneur s√©par√© pour le bouton quiz
                    const buttonContainer = document.createElement('div');
                    buttonContainer.style.cssText = `
                        background: white;
                        padding: 10px;
                        border-radius: 0 0 10px 10px;
                        border-top: 1px solid #e2e8f0;
                    `;
                    
                    const quizButton = document.createElement('button');
                    quizButton.textContent = 'üìù Faire le quiz';
                    quizButton.style.cssText = `
                        width: 100%;
                        padding: 10px;
                        background: #48bb78;
                        color: white;
                        border: none;
                        border-radius: 8px;
                        cursor: pointer;
                        font-size: 14px;
                    `;
                    
                    quizButton.addEventListener('click', function(e) {
                        e.stopPropagation();
                        console.log('CLIC sur le bouton quiz pour:', video.title);
                        currentVideo = video;
                        startQuiz();
                    });
                    
                    buttonContainer.appendChild(quizButton);
                    videoCard.appendChild(buttonContainer);
                });
            } else {
                console.log('Pas de contenu trouv√© pour:', currentClass, currentSubject);
            }
        }

        // Fonction pour afficher le lecteur vid√©o
        function showVideoPlayer(video) {
            currentVideo = video;
            
            // Masquer les autres sections et afficher le lecteur vid√©o
            document.getElementById('videos-section').classList.add('hidden');
            document.getElementById('video-player').classList.remove('hidden');
            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('subjects-section').classList.add('hidden');
            
            // Mettre √† jour le titre
            document.getElementById('video-title').textContent = video.title;
            
            // Int√©grer la vid√©o YouTube directement dans le site
            const videoContainer = document.querySelector('.video-info-card');
            const youtubeID = getYouTubeID(video.url);
            
            if (youtubeID && videoContainer) {
                videoContainer.innerHTML = `
                    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; background: #000; border-radius: 10px; margin-bottom: 15px;">
                        <iframe 
                            src="https://www.youtube.com/embed/${youtubeID}?rel=0&modestbranding=1&showinfo=0&controls=1" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                        ></iframe>
                    </div>
                    <p style="color: #4a5568; text-align: center;">Une fois que tu as regard√© la vid√©o, tu peux faire le quiz ci-dessous !</p>
                `;
            } else {
                videoContainer.innerHTML = `
                    <p style="color: #e53e3e; text-align: center;">Erreur : Impossible de charger la vid√©o</p>
                    <p style="color: #4a5568; text-align: center;">URL: ${video.url}</p>
                `;
            }
        }

        // Fonction pour ouvrir la vid√©o YouTube (plus utilis√©e mais gard√©e pour compatibilit√©)
        function openVideo() {
            // Cette fonction n'est plus utilis√©e car les vid√©os sont maintenant int√©gr√©es
            // mais on la garde au cas o√π
            if (currentVideo && currentVideo.url) {
                window.open(currentVideo.url, '_blank');
            }
        }

        // Fonction pour d√©marrer le quiz
        function startQuiz() {
            if (currentVideo && currentVideo.quiz) {
                currentQuizQuestions = currentVideo.quiz;
                currentQuestionIndex = 0;
                quizAnswers = [];
                
                document.getElementById('video-player').classList.add('hidden');
                document.getElementById('quiz-section').classList.remove('hidden');
                document.getElementById('quiz-title').textContent = currentVideo.title;
                
                showQuestion();
            }
        }

        // Fonction pour afficher une question
        function showQuestion() {
            if (currentQuestionIndex < currentQuizQuestions.length) {
                const question = currentQuizQuestions[currentQuestionIndex];
                const quizContent = document.getElementById('quiz-content');
                
                quizContent.innerHTML = `
                    <div class="quiz-question">
                        <h3>Question ${currentQuestionIndex + 1}/${currentQuizQuestions.length}</h3>
                        <p><strong>${question.question}</strong></p>
                        <ul class="quiz-options">
                            ${question.options.map((option, index) => 
                                `<li onclick="selectAnswer(${index})" data-index="${index}">${option}</li>`
                            ).join('')}
                        </ul>
                    </div>
                `;
                
                document.getElementById('quiz-submit').classList.add('hidden');
                document.getElementById('quiz-next').classList.add('hidden');
                document.getElementById('quiz-results').classList.add('hidden');
            } else {
                showQuizResults();
            }
        }

        // Fonction pour s√©lectionner une r√©ponse
        function selectAnswer(answerIndex) {
            const question = currentQuizQuestions[currentQuestionIndex];
            const options = document.querySelectorAll('.quiz-options li');
            
            // Emp√™cher de cliquer √† nouveau si d√©j√† r√©pondu
            if (options[0].classList.contains('disabled')) {
                return;
            }
            
            // D√©sactiver tous les clics
            options.forEach(option => {
                option.classList.add('disabled');
                option.style.pointerEvents = 'none';
            });
            
            // Marquer la r√©ponse s√©lectionn√©e
            const selectedOption = document.querySelector(`[data-index="${answerIndex}"]`);
            selectedOption.classList.add('selected');
            
            // Enregistrer la r√©ponse
            quizAnswers[currentQuestionIndex] = answerIndex;
            
            // Afficher les bonnes et mauvaises r√©ponses
            options.forEach((option, index) => {
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === answerIndex && answerIndex !== question.correct) {
                    option.classList.add('incorrect');
                }
            });
            
            // Afficher l'explication si la r√©ponse est correcte ou incorrecte
            const questionDiv = document.querySelector('.quiz-question');
            let explanationText = '';
            
            if (answerIndex === question.correct) {
                // Ajouter 10 points pour une bonne r√©ponse
                userPoints += 10;
                updatePointsDisplay();
                
                explanationText = `<div style="background: #c6f6d5; border: 2px solid #48bb78; padding: 15px; border-radius: 8px; margin-top: 15px; color: #22543d;">
                    <strong>‚úÖ Bonne r√©ponse ! +10 points üéâ</strong><br>
                    ${question.explanation || 'Bien jou√© !'}
                </div>`;
            } else {
                explanationText = `<div style="background: #fed7d7; border: 2px solid #f56565; padding: 15px; border-radius: 8px; margin-top: 15px; color: #742a2a;">
                    <strong>‚ùå Ce n'est pas la bonne r√©ponse.</strong><br>
                    La bonne r√©ponse est : <strong>"${question.options[question.correct]}"</strong><br><br>
                    <strong>Pourquoi ?</strong> ${question.explanation || 'Regarde bien la vid√©o pour mieux comprendre !'}
                </div>`;
            }
            
            questionDiv.insertAdjacentHTML('beforeend', explanationText);
            
            // Afficher le bouton suivant ou terminer
            if (currentQuestionIndex < currentQuizQuestions.length - 1) {
                document.getElementById('quiz-next').classList.remove('hidden');
            } else {
                document.getElementById('quiz-submit').classList.remove('hidden');
            }
        }

        // Fonction pour passer √† la question suivante
        function nextQuestion() {
            currentQuestionIndex++;
            showQuestion();
        }

        // Fonction pour soumettre le quiz
        function submitQuiz() {
            showQuizResults();
        }

        // Fonction pour afficher les r√©sultats
        function showQuizResults() {
            let score = 0;
            
            currentQuizQuestions.forEach((question, index) => {
                if (quizAnswers[index] === question.correct) {
                    score++;
                }
            });
            
            const percentage = Math.round((score / currentQuizQuestions.length) * 100);
            
            document.getElementById('quiz-content').innerHTML = '';
            document.getElementById('quiz-submit').classList.add('hidden');
            document.getElementById('quiz-next').classList.add('hidden');
            
            const resultsDiv = document.getElementById('quiz-results');
            resultsDiv.classList.remove('hidden');
            
            let message = '';
            if (percentage >= 80) {
                message = 'üéâ Excellent travail !';
            } else if (percentage >= 60) {
                message = 'üëç Bon travail !';
            } else {
                message = 'üí™ Continue tes efforts !';
            }
            
            document.getElementById('quiz-score').innerHTML = `
                <strong>Score : ${score}/${currentQuizQuestions.length} (${percentage}%)</strong><br><br>
                ${message}<br><br>
                <button onclick="restartQuiz()" style="background: #667eea; color: white; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; margin: 5px;">
                    üîÑ Refaire le quiz
                </button>
            `;
        }

        // Fonction pour recommencer le quiz
        function restartQuiz() {
            if (currentVideo && currentVideo.quiz) {
                currentQuizQuestions = currentVideo.quiz;
                currentQuestionIndex = 0;
                quizAnswers = [];
                
                // Masquer les r√©sultats et recommencer
                document.getElementById('quiz-results').classList.add('hidden');
                showQuestion();
            }
        }

        // Fonction pour retourner au lecteur vid√©o (depuis le quiz)
        function backToVideoPlayer() {
            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('video-player').classList.remove('hidden');
        }

        // Fonction pour sauvegarder automatiquement le profil
        function autoSaveProfile() {
            if (!isGuest && currentUser && currentClass) {
                const profile = {
                    username: currentUser,
                    class: currentClass,
                    progress: userProgress,
                    points: userPoints,
                    savedDate: new Date().toISOString()
                };
                
                const dataStr = JSON.stringify(profile, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `profil_${currentUser}_${currentClass}.json`;
                link.click();
                
                alert('Profil sauvegard√© automatiquement ! üíæ');
            }
        }

        // Fonction pour sauvegarder le profil manuellement
        function saveProfile() {
            if (isGuest) {
                alert('Les invit√©s ne peuvent pas sauvegarder leur profil ! Cr√©ez un compte pour sauvegarder.');
                return;
            }
            
            const profile = {
                username: currentUser,
                class: currentClass,
                progress: userProgress,
                points: userPoints,
                savedDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(profile, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `profil_${currentUser}_${currentClass}.json`;
            link.click();
            
            alert('Profil sauvegard√© ! üíæ');
        }
    </script>
</body>
</html>